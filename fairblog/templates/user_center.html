{% extends 'base.html' %}
{% block head %}
<link rel="icon" type="image/x-icon" href="#"/>
<link rel="stylesheet" href="/static/css/user_center.css">

<style>

</style>
{% endblock %}

{% block body %}
<div class="modal fade" id="userInfo" tabindex="-1" role="dialog" aria-labelledby="userInfo" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userInfoLabel">用户信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon1">用户名</span>
                    </div>
                    <input type="text" class="form-control" readonly="readonly" aria-label="Username"
                           aria-describedby="basic-addon1">
                </div>

                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon2">用户名</span>
                    </div>
                    <input type="text" class="form-control" readonly="readonly" aria-label="Username"
                           aria-describedby="basic-addon2">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary">确认</button>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="row">
        <div class="col"></div>
        <div class="col-lg-10">
            <div class="user row">
                <div class="col-lg-4">
                    <img id="avatar" src="/static/img/me.png" alt="">
                </div>

                <div class="col">
                    <span id="username">paulpaulzhag</span>
                    <button type="button" class="btn btn-light" id="edit" onclick="userInfoEdit()">
                        编辑
                    </button>
                    <span id="introduction">lalalalalalalalalalalala</span>
                </div>
            </div>

            <div id="posts-container" class="row">
                <div class="col-lg-4 post-col"></div>
                <div class="col-lg-4 post-col"></div>
                <div class="col-lg-4 post-col"></div>
            </div>
        </div>
        <div class="col"></div>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
    function loadPicture(pid, content, image) {
        let post_cols = document.getElementsByClassName("post-col");
        let width = parseFloat(window.getComputedStyle(post_cols[0]).getPropertyValue("width")) - 30; //30为边距
        return '<div class="img-box">\n' +
            '      <img class="img" src="' + image + '" style="width: ' + width + 'px; height: auto" alt="">\n' +
            '      <div class="content-div" style="width: 100%; height: 100%;">' +
            '            <span class="content">' + content + '</span>\n' +
            '      </div>\n' +
            '  </div>'
    }

    $.ajax({
        url: "{{ url_for('app_user_center.get_post_by_uid') }}",
        data: {"uid": 1},
        type: "POST",
        success: function (response) {
            let post_cols = document.getElementsByClassName("post-col");
            let posts = $.parseJSON(response);
            let col = 0;
            for (let i = 0; i < posts.length; i++) {
                let picture = loadPicture(posts[i].pid, posts[i].content, posts[i].image);
                $(post_cols[col]).append(picture);
                col += 1;
                if (col > 2) {
                    col = 0;
                }
            }
        },
        error: function () {

        }
    });

    function userInfoEdit() {
        $("#userInfo").modal({
            backdrop: 'static',
            keyboard: false
        })
    }
</script>
{% endblock %}